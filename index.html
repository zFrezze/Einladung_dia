<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Einladung – Teil 1</title>
<style>
  :root{
    --ink:#0e1b2b;
    --paper-hi:#ffffff; --paper-mid:#eef2f7; --paper-lo:#dfe6ee;
    --liner-hi:#ffffff; --liner-lo:#eaf0f7;
    --shadow-strong: 0 30px 90px rgba(10,20,40,.28);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;display:grid;place-items:center;background:linear-gradient(180deg,#f9fbff,#edf3fa);
    font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink);
    overflow:hidden;padding:18px
  }

  /* Umschlag */
  .env-frame{position:relative;width:min(700px,94vw);aspect-ratio:4/3;perspective:1800px;overflow:visible}
  .env-body{
    position:absolute;inset:0;border-radius:18px;z-index:2;overflow:hidden;
    background:linear-gradient(180deg,var(--paper-hi) 0%, var(--paper-mid) 60%, var(--paper-lo) 100%);
    box-shadow: var(--shadow-strong);
  }
  .env-liner{position:absolute;inset:0;border-radius:18px;z-index:1;opacity:0;background:linear-gradient(180deg,var(--liner-hi),var(--liner-lo))}
  .env-patch{position:absolute;inset:0;border-radius:18px;z-index:2;opacity:0;background:var(--liner-hi);clip-path:polygon(0 0,100% 0,50% 57%)}
  .flap-top{
    position:absolute;inset:0;z-index:4;transform-style:preserve-3d;
    background: linear-gradient(180deg,#ffffff 0%, #f3f7fb 100%);
    clip-path:polygon(0 0,100% 0,50% 57%);
    transform-origin:50% 0%; transform:rotateX(0deg);
  }
  .flap-shadow{position:absolute;left:8%;right:8%;top:52%;height:18px;z-index:3;
    background:radial-gradient(50% 100% at 50% 0%, rgba(0,0,0,.22), transparent 70%);opacity:.6}

  /* Siegel */
  .seal-wrap{
    position:absolute;left:50%;top:48%;transform:translate(-50%,-50%);
    width:140px;height:140px;z-index:6;display:flex;justify-content:center;align-items:center;
  }
  .seal-intact{
    width:100%;height:100%;border-radius:50%;background:#a83232;
    box-shadow:0 5px 20px rgba(168,50,50,0.5), inset 0 0 0 8px rgba(255,255,255,0.3);
    display:flex;justify-content:center;align-items:center;
    position:relative;overflow:hidden;cursor:pointer;
  }
  .seal-intact:before{
    content:'';position:absolute;width:100%;height:100%;
    background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4) 0%, transparent 60%);
  }
  .seal-intact:after{
    content:'';position:absolute;width:90%;height:90%;border-radius:50%;
    border:2px dashed rgba(255,215,0,0.5);
  }
  .seal-hh{
    font-family:'Times New Roman', serif;font-size:42px;font-weight:bold;
    color:rgba(255,215,0,0.85);text-shadow:1px 1px 3px rgba(0,0,0,0.3);
    letter-spacing:2px;
  }
  
  /* Karte */
  .card-wrap{
    position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
    width:min(460px,76vmin);height:min(460px,76vmin);
    z-index:3;clip-path:polygon(0 0,100% 0,50% 57%);
  }
  .card-img{
    position:absolute;left:50%;top:50%;
    transform:translate(-50%,-50%) translateY(60%) scale(.48);
    width:100%;height:auto;opacity:.95;
    filter: drop-shadow(0 30px 70px rgba(0,0,0,.25));
    cursor:pointer;user-select:none;
    backface-visibility: hidden;
  }
  .card-back {
    position:absolute;left:50%;top:50%;
    transform:translate(-50%,-50%) translateY(60%) scale(.48) rotateY(180deg);
    width:100%;height:auto;opacity:0;
    filter: drop-shadow(0 30px 70px rgba(0,0,0,.25));
    cursor:pointer;user-select:none;
    backface-visibility: hidden;
  }
</style>
</head>
<body>
  <div class="env-frame" id="frame">
    <div class="env-body"></div>
    <div class="env-liner" id="envLiner"></div>
    <div class="env-patch" id="envPatch"></div>
    <div class="flap-top" id="flapTop"></div>
    <div class="flap-shadow" id="flapShadow"></div>

    <!-- Siegel -->
    <div class="seal-wrap" id="sealWrap">
      <div class="seal-intact" id="sealIntact">
        <div class="seal-hh">HH</div>
      </div>
    </div>

    <!-- Karte -->
    <div class="card-wrap" id="cardWrap" aria-hidden="true">
      <img src="https://images.unsplash.com/photo-1533924275610-4ff8475e8f15?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Einladungskarte" id="cardImg" class="card-img">
      <img src="https://images.unsplash.com/photo-1519457431-44ccd64a579b?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Rückseite der Einladungskarte" id="cardBack" class="card-back">
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script>
    let state=0;
    const flapTop=document.getElementById('flapTop');
    const flapShadow=document.getElementById('flapShadow');
    const envLiner=document.getElementById('envLiner');
    const envPatch=document.getElementById('envPatch');
    const sealIntact=document.getElementById('sealIntact');
    const cardWrap=document.getElementById('cardWrap');
    const cardImg=document.getElementById('cardImg');
    const cardBack=document.getElementById('cardBack');

    function breakSeal(){
      // Erstellt mehrere Bruchstücke für den Siegelbruch-Effekt
      const sealPieces = [];
      const pieces = 5;
      
      for (let i = 0; i < pieces; i++) {
        const piece = document.createElement('div');
        piece.className = 'seal-piece';
        piece.style.cssText = `
          position: absolute;
          width: 50%;
          height: 50%;
          background: #a83232;
          border-radius: 50%;
          top: ${25 + (i % 2) * 25}%;
          left: ${25 + Math.floor(i / 2) * 25}%;
          transform-origin: ${i % 2 ? 'left' : 'right'} ${Math.floor(i / 2) ? 'bottom' : 'top'};
        `;
        sealIntact.appendChild(piece);
        sealPieces.push(piece);
      }
      
      // Animiert das Zerbrechen des Siegels
      gsap.to(sealIntact, {
        duration: 0.6,
        scale: 1.2,
        rotation: 15,
        ease: "power2.out"
      });
      
      gsap.to(sealPieces, {
        duration: 0.8,
        rotation: "+=60",
        x: () => Math.random() * 100 - 50,
        y: () => Math.random() * 100 - 50,
        opacity: 0,
        stagger: 0.05,
        ease: "power2.out",
        onComplete: () => {
          sealIntact.style.display = "none";
        }
      });
      
      state=1;
    }

    function openEnvelopeAndCard(){
      gsap.to(flapTop,   {duration:2.0,rotationX:-120,ease:"power2.inOut"});
      gsap.to(flapShadow,{duration:2.0,opacity:.20,y:-24,ease:"power2.inOut"});
      gsap.to(envLiner,  {duration:.9, opacity:1, delay:.5});
      gsap.to(envPatch,  {duration:.9, opacity:1, delay:.5});

      const tl=gsap.timeline({delay:0.95,defaults:{ease:"power2.inOut"}});
      tl.to([cardImg, cardBack],{duration:1.7,y:"-=90%",scale:.25,rotation:-8,opacity:1});
      tl.add(()=>{document.querySelector('.card-wrap').style.clipPath='none'; gsap.set(cardWrap,{zIndex:7});});
      tl.to([cardImg, cardBack],{duration:1.6,y:"-50%",scale:1.0,rotation:0});
      
      // Nach 1.5 Sekunden die Karte umdrehen
      tl.add(() => {
        setTimeout(() => {
          gsap.to(cardImg, {duration: 1.0, rotationY: 180, opacity: 0});
          gsap.to(cardBack, {duration: 1.0, rotationY: 0, opacity: 1, delay: 0.1});
        }, 1500);
      });
      
      state=2;
    }

    document.getElementById('frame').addEventListener('click',()=>{
      if(state===0) breakSeal();
      else if(state===1) openEnvelopeAndCard();
    });
  </script>
</body>
</html>
