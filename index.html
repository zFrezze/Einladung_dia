<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Einladung</title>
<style>
  body{
    margin:0;display:grid;place-items:center;height:100vh;
    background:linear-gradient(180deg,#f9fbff,#edf3fa);
  }
  .env-frame{position:relative;width:min(700px,94vw);aspect-ratio:4/3;perspective:1800px}
  .env-body{position:absolute;inset:0;border-radius:18px;background:#fff;box-shadow:0 30px 90px rgba(0,0,0,.28);z-index:2}
  .flap-top{position:absolute;inset:0;clip-path:polygon(0 0,100% 0,50% 57%);
    background:#f3f7fb;z-index:4;transform-origin:50% 0%;transform:rotateX(0deg)}
  .flap-shadow{position:absolute;left:8%;right:8%;top:52%;height:18px;z-index:3;
    background:radial-gradient(50% 100% at 50% 0%,rgba(0,0,0,.22),transparent 70%)}

  /* Siegel */
  .seal-wrap{position:absolute;left:50%;top:48%;transform:translate(-50%,-50%);width:140px;height:140px;z-index:6}
  .seal-intact img{width:100%;height:auto}

  /* Karte (Flip-Container = #cardImg) */
  .card-wrap{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
    width:min(460px,76vmin);height:min(460px,76vmin);z-index:3;clip-path:polygon(0 0,100% 0,50% 57%)}
  #cardImg{
    position:absolute;left:50%;top:50%;
    transform:translate(-50%,-50%) translateY(60%) scale(.48);
    width:100%;height:auto;opacity:0.95;
    filter:drop-shadow(0 30px 70px rgba(0,0,0,.25));
    transform-style:preserve-3d;
  }
  .card-face{position:absolute;left:0;top:0;width:100%;backface-visibility:hidden;border-radius:12px}
  .card-face.back{transform:rotateY(180deg)}
</style>
</head>
<body>
  <div class="env-frame" id="frame">
    <div class="env-body"></div>
    <div class="flap-top" id="flapTop"></div>
    <div class="flap-shadow" id="flapShadow"></div>

    <!-- Siegel -->
    <div class="seal-wrap" id="sealWrap">
      <div class="seal-intact" id="sealIntact">
        <img src="seal.png" alt="Siegel"><div class="seal-hh">HH</div>
      </div>
    </div>

    <!-- Karte -->
    <div class="card-wrap" id="cardWrap" aria-hidden="true">
      <div id="cardImg">
        <img src="diamond.jpg"   class="card-face front" alt="Vorderseite">
        <img src="diamond_2.png" class="card-face back"  alt="RÃ¼ckseite">
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script>
    let state=0;
    const flapTop=document.getElementById('flapTop');
    const flapShadow=document.getElementById('flapShadow');
    const sealIntact=document.getElementById('sealIntact');
    const cardWrap=document.getElementById('cardWrap');
    const cardImg=document.getElementById('cardImg');

    function breakSealSlow(){
      gsap.to(sealIntact,{duration:.2,scale:1.1,yoyo:true,repeat:1,onComplete:()=>sealIntact.style.display="none"});
      state=1;
    }

    function openEnvelopeAndCardTwoStage(){
      gsap.to(flapTop,{duration:2,rotationX:-120,ease:"power2.inOut"});
      gsap.to(flapShadow,{duration:2,opacity:.2,y:-24,ease:"power2.inOut"});

      const tl=gsap.timeline({delay:.95,defaults:{ease:"power2.inOut"}});
      // rausfliegen wie vorher
      tl.to(cardImg,{duration:1.7,y:"-=90%",scale:.25,rotation:-8,opacity:1});
      tl.add(()=>{document.querySelector('.card-wrap').style.clipPath='none'; gsap.set(cardWrap,{zIndex:7});});
      tl.to(cardImg,{duration:1.6,y:"-50%",scale:1,rotation:0,onComplete:()=>{
        // automatischer Flip
        gsap.to(cardImg,{duration:1,rotateY:180,ease:"power2.inOut",delay:1.5});
      }});
      state=2;
    }

    document.getElementById('frame').addEventListener('click',()=>{
      if(state===0) breakSealSlow();
      else if(state===1) openEnvelopeAndCardTwoStage();
    });
  </script>
</body>
</html>
